(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{88874:function(e,t,a){Promise.resolve().then(a.bind(a,38489)),Promise.resolve().then(a.bind(a,29079))},38489:function(e,t,a){"use strict";a.d(t,{default:function(){return eI}});var n=a(57437),l=a(2265),s=a(29079),i=a(94987);a(70605);var o=a(22833),r=a(87592),d=a(22468),c=a(28165),u=a(44839),f=a(96164);function m(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,f.m6)((0,u.W)(t))}let x=o.fC,p=o.xz;o.ZA,o.Uv;let v=o.Tr;o.Ee;let h=l.forwardRef((e,t)=>{let{className:a,inset:l,children:s,...i}=e;return(0,n.jsxs)(o.fF,{ref:t,className:m("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",l&&"pl-8",a),...i,children:[s,(0,n.jsx)(r.Z,{className:"ml-auto h-4 w-4"})]})});h.displayName=o.fF.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(o.tu,{ref:t,className:m("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});g.displayName=o.tu.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(o.Uv,{children:(0,n.jsx)(o.VY,{ref:t,className:m("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});j.displayName=o.VY.displayName;let b=l.forwardRef((e,t)=>{let{className:a,inset:l,...s}=e;return(0,n.jsx)(o.ck,{ref:t,className:m("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",a),...s})});b.displayName=o.ck.displayName,l.forwardRef((e,t)=>{let{className:a,children:l,checked:s,...i}=e;return(0,n.jsxs)(o.oC,{ref:t,className:m("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:s,...i,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(o.wU,{children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})})}),l]})}).displayName=o.oC.displayName,l.forwardRef((e,t)=>{let{className:a,children:l,...s}=e;return(0,n.jsxs)(o.Rk,{ref:t,className:m("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(o.wU,{children:(0,n.jsx)(c.Z,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=o.Rk.displayName,l.forwardRef((e,t)=>{let{className:a,inset:l,...s}=e;return(0,n.jsx)(o.__,{ref:t,className:m("px-2 py-1.5 text-sm font-semibold text-foreground",l&&"pl-8",a),...s})}).displayName=o.__.displayName;let y=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(o.Z0,{ref:t,className:m("-mx-1 my-1 h-px bg-border",a),...l})});y.displayName=o.Z0.displayName;let w=[];function S(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=0;for(;;){(t+=1)>10&&console.warn("getId.ts attempt ".concat(t,"! Increase the idLength."));let a=function(e){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",a="";for(let n=0;n<e;n++){let e=Math.floor(Math.random()*(t.length-1));a+=t[e]}return a}(e);if(!w.includes(a))return w.push(a),a}}function C(e){let{setNodes:t,children:a}=e,{screenToFlowPosition:i}=(0,s._K)(),o=(0,l.useCallback)((e,a,n)=>{let l={id:"random".concat(S()),position:i({x:e,y:a}),type:n,data:{instance:null},origin:[.5,0]};t(e=>e.concat(l))},[t,i]);return(0,n.jsxs)(x,{children:[(0,n.jsx)(p,{children:a}),(0,n.jsxs)(j,{className:"w-64",children:[(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"ST"),children:"New SimpleTable"}),(0,n.jsx)(y,{}),(0,n.jsxs)(v,{children:[(0,n.jsx)(h,{children:"Importing data"}),(0,n.jsxs)(g,{className:"w-48",children:[(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"FetchData"),children:"Fetch data"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"FetchGeoData"),children:"Fetch geo data"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"LoadFile"),children:"Load file"})]})]}),(0,n.jsxs)(v,{children:[(0,n.jsx)(h,{children:"Restructuring data"}),(0,n.jsxs)(g,{className:"w-48",children:[(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"AddColumn"),children:"Add column"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"Filter"),children:"Filter"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"Join"),children:"Join"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"RenameColumns"),children:"Rename columns"})]})]}),(0,n.jsxs)(v,{children:[(0,n.jsx)(h,{children:"Analyzing data"}),(0,n.jsxs)(g,{className:"w-48",children:[(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"LinearRegressions"),children:"Linear regression"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"Sort"),children:"Sort"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"Summarize"),children:"Summarize"})]})]}),(0,n.jsxs)(v,{children:[(0,n.jsx)(h,{children:"Geospatial"}),(0,n.jsxs)(g,{className:"w-48",children:[(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"JoinGeo"),children:"Join geo"}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"Points"),children:"Points"})]})]}),(0,n.jsx)(y,{}),(0,n.jsx)(b,{onClick:e=>o(e.clientX,e.clientY,"LogTable"),children:"Log table"})]})]})}var N=a(6);let R=null,T=!1,k=!1;async function E(e){var t;return R||T||k||(T=!0,R=await (0,N.e$)({themes:["slack-ochin"],langs:["ts"]}),k=!0),null!==(t=null==R?void 0:R.codeToHtml(e,{lang:"ts",theme:"slack-ochin"}))&&void 0!==t?t:""}function Z(){return(0,n.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M9.96424 2.68571C10.0668 2.42931 9.94209 2.13833 9.6857 2.03577C9.4293 1.93322 9.13832 2.05792 9.03576 2.31432L5.03576 12.3143C4.9332 12.5707 5.05791 12.8617 5.3143 12.9642C5.5707 13.0668 5.86168 12.9421 5.96424 12.6857L9.96424 2.68571ZM3.85355 5.14646C4.04882 5.34172 4.04882 5.6583 3.85355 5.85356L2.20711 7.50001L3.85355 9.14646C4.04882 9.34172 4.04882 9.6583 3.85355 9.85356C3.65829 10.0488 3.34171 10.0488 3.14645 9.85356L1.14645 7.85356C0.951184 7.6583 0.951184 7.34172 1.14645 7.14646L3.14645 5.14646C3.34171 4.9512 3.65829 4.9512 3.85355 5.14646ZM11.1464 5.14646C11.3417 4.9512 11.6583 4.9512 11.8536 5.14646L13.8536 7.14646C14.0488 7.34172 14.0488 7.6583 13.8536 7.85356L11.8536 9.85356C11.6583 10.0488 11.3417 10.0488 11.1464 9.85356C10.9512 9.6583 10.9512 9.34172 11.1464 9.14646L12.7929 7.50001L11.1464 5.85356C10.9512 5.6583 10.9512 5.34172 11.1464 5.14646Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var L=a(71538),A=a(12218);let P=(0,A.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),D=l.forwardRef((e,t)=>{let{className:a,variant:l,size:s,asChild:i=!1,...o}=e,r=i?L.g7:"button";return(0,n.jsx)(r,{className:m(P({variant:l,size:s,className:a})),ref:t,...o})});function V(){return(0,n.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function _(e){let{code:t,border:a,left:s}=e,[i,o]=(0,l.useState)(""),[r,d]=(0,l.useState)(!1);(0,l.useEffect)(()=>{!async function(){o(await E(t))}()},[t]);let c=(0,l.useCallback)(()=>{navigator.clipboard.writeText(t)},[t]);return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"absolute m-auto left-auto right-0",children:[(0,n.jsx)(D,{variant:"outline",size:"icon",className:a?"bg-white m-2":"m-1 h-9 px-0 border-none",onClick:()=>d(!r),children:(0,n.jsx)(Z,{})}),r&&(0,n.jsxs)("div",{className:"absolute ".concat(s?"-translate-x-full top-2":"translate-x-14 top-0","  rounded-lg border bg-card text-card-foreground shadow-sm flex justify-between"),children:[(0,n.jsx)("div",{className:"p-4",dangerouslySetInnerHTML:{__html:i}}),(0,n.jsx)("div",{children:(0,n.jsx)(D,{variant:"outline",size:"icon",className:"m-1 h-9 px-0 py-0 border-none",onClick:c,children:(0,n.jsx)(V,{})})})]})]})})}function F(){let[e,t]=(0,l.useState)(!1),[a,i]=(0,l.useState)(""),o=(0,s.SM)(),r=(0,l.useMemo)(()=>o.map(e=>e.id),[o]),d=(0,s.$P)(r);return(0,l.useEffect)(()=>{e&&i(d.map(e=>e.data.code).filter(e=>""!==e&&null!=e).join("\n\n"))},[d,e]),(0,n.jsx)("div",{className:"z-10",onClick:()=>t(!e),children:(0,n.jsx)(_,{code:a,border:!0,left:!0})})}D.displayName="Button";let M="node_".concat(S()),z="node_".concat(S()),O=[{id:M,type:"SDB",position:{x:0,y:0},data:{instance:null},origin:[.5,0]},{id:z,type:"ST",position:{x:-50,y:150},data:{instance:null,name:z},origin:[.5,0]}],$=[{id:"edge_".concat(S()),source:M,target:z}],H=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("div",{ref:t,className:m("rounded-lg border bg-card text-card-foreground shadow-sm",a),...l})});H.displayName="Card";let J=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("div",{ref:t,className:m("flex flex-col space-y-1.5 p-6",a),...l})});J.displayName="CardHeader";let Y=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("h3",{ref:t,className:m("text-2xl font-semibold leading-none tracking-tight",a),...l})});Y.displayName="CardTitle";let B=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("p",{ref:t,className:m("text-sm text-muted-foreground",a),...l})});B.displayName="CardDescription";let G=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("div",{ref:t,className:m("p-6 pt-0",a),...l})});G.displayName="CardContent",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("div",{ref:t,className:m("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter";var K=a(75313);function I(e){let{sourceReady:t}=e;return(0,n.jsx)(s.HH,{type:"source",position:i.Ly.Bottom,style:{width:"50px",height:"4px",borderRadius:"0 0 4px 4px",border:"none",position:"relative",transform:"translate(-50%, -1px)",background:t?"#94a3b8":"#d3d3d3"}})}var q=a(48059),U=a.n(q);function X(e){let{show:t}=e;return t&&(0,n.jsx)("div",{className:"jsx-701ffc446e3075ed spinner",children:(0,n.jsx)(U(),{id:"701ffc446e3075ed",children:".spinner.jsx-701ffc446e3075ed{display:inline;border:3px solid rgba(0,0,0,.1);border-left-color:black;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:16px;height:16px;-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})})}function W(e){let{loader:t,children:a}=e;return(0,n.jsxs)("div",{className:"flex gap-x-2 items-center",children:[(0,n.jsx)(Y,{children:a}),(0,n.jsx)(X,{show:t})]})}function Q(e){let{targetReady:t,id:a}=e;return(0,n.jsx)(s.HH,{id:a,type:"target",position:i.Ly.Top,style:{width:"50px",height:"5px",borderRadius:"4px 4px 0 0",border:"none",position:"relative",transform:"translate(-50%, 1px)",background:t?"#94a3b8":"#d3d3d3"}})}let ee=l.forwardRef((e,t)=>{let{className:a,type:l,...s}=e;return(0,n.jsx)("input",{type:l,className:m("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:cursor-pointer placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});ee.displayName="Input";var et=a(38364);let ea=(0,A.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),en=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(et.f,{ref:t,className:m(ea(),a),...l})});function el(e){let{smallMargin:t,children:a}=e;return(0,n.jsx)("div",{className:"flex items-center space-x-2 ".concat(t?"my-2":"my-4"),children:a})}function es(e){let{label:t,value:a,onClick:s}=e,i=(0,l.useRef)(null),[o,r]=(0,l.useState)("");return(0,l.useEffect)(()=>{r(a)},[a]),(0,n.jsxs)(el,{children:[(0,n.jsx)(en,{children:t}),(0,n.jsx)(ee,{ref:i,type:"text",value:o,onChange:e=>r(e.target.value),onKeyDown:e=>{"Enter"===e.key&&i.current&&s(i.current.value)}}),(0,n.jsx)(D,{onClick:()=>i.current&&"string"==typeof i.current.value&&s(i.current.value),children:"Update"})]})}en.displayName=et.f.displayName;var ei=a(74454),eo=a(64756),er=a(42421);let ed=eo.fC,ec=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(eo.ck,{ref:t,className:m(a),...l})});ec.displayName="AccordionItem";let eu=l.forwardRef((e,t)=>{let{className:a,children:l,...s}=e;return(0,n.jsx)(eo.h4,{className:"flex",children:(0,n.jsxs)(eo.xz,{ref:t,className:m("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...s,children:[l,(0,n.jsx)(er.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});eu.displayName=eo.xz.displayName;let ef=l.forwardRef((e,t)=>{let{className:a,children:l,...s}=e;return(0,n.jsx)(eo.VY,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...s,children:(0,n.jsx)("div",{className:m("pb-4 pt-0",a),children:l})})});function em(e){let{children:t}=e;return(0,n.jsx)(ed,{type:"single",collapsible:!0,className:"mt-3",children:(0,n.jsxs)(ec,{value:"item-1",children:[(0,n.jsx)(eu,{children:"Options"}),(0,n.jsx)(ef,{children:t})]})})}ef.displayName=eo.VY.displayName;var ex=a(69324);let ep=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(ex.fC,{ref:t,className:m("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:(0,n.jsx)(ex.z$,{className:m("flex items-center justify-center text-current"),children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})})})});function ev(e){let{label:t,defaultChecked:a,checked:l,onChange:s,smallMargin:i}=e;return(0,n.jsxs)(el,{smallMargin:i,children:[(0,n.jsx)(ep,{checked:l,defaultChecked:a,onCheckedChange:s}),(0,n.jsx)(en,{className:"".concat(i?"font-normal":""),children:t})]})}ep.displayName=ex.fC.displayName;var eh=a(53267),eg=a(14392);let ej=eh.fC,eb=eh.ZA,ey=eh.B4,ew=l.forwardRef((e,t)=>{let{className:a,children:l,...s}=e;return(0,n.jsxs)(eh.xz,{ref:t,className:m("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[l,(0,n.jsx)(eh.JO,{asChild:!0,children:(0,n.jsx)(er.Z,{className:"h-4 w-4 opacity-50"})})]})});ew.displayName=eh.xz.displayName;let eS=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(eh.u_,{ref:t,className:m("flex cursor-default items-center justify-center py-1",a),...l,children:(0,n.jsx)(eg.Z,{className:"h-4 w-4"})})});eS.displayName=eh.u_.displayName;let eC=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(eh.$G,{ref:t,className:m("flex cursor-default items-center justify-center py-1",a),...l,children:(0,n.jsx)(er.Z,{className:"h-4 w-4"})})});eC.displayName=eh.$G.displayName;let eN=l.forwardRef((e,t)=>{let{className:a,children:l,position:s="popper",...i}=e;return(0,n.jsx)(eh.h_,{children:(0,n.jsxs)(eh.VY,{ref:t,className:m("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...i,children:[(0,n.jsx)(eS,{}),(0,n.jsx)(eh.l_,{className:m("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,n.jsx)(eC,{})]})})});eN.displayName=eh.VY.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(eh.__,{ref:t,className:m("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=eh.__.displayName;let eR=l.forwardRef((e,t)=>{let{className:a,children:l,...s}=e;return(0,n.jsxs)(eh.ck,{ref:t,className:m("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(eh.wU,{children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(eh.eT,{children:l})]})});function eT(e){let{label:t,placeholder:a,items:l,onChange:s,value:i}=e;return(0,n.jsxs)(el,{children:[(0,n.jsx)(en,{children:t}),(0,n.jsxs)(ej,{onValueChange:s,value:i,children:[(0,n.jsx)(ew,{className:"w-[180px]",children:(0,n.jsx)(ey,{placeholder:a})}),(0,n.jsx)(eN,{children:(0,n.jsx)(eb,{children:l.map((e,t)=>(0,n.jsx)(eR,{value:e.value,children:e.label},t))})})]})]})}function ek(e){let{label:t,value:a,set:l}=e;return(0,n.jsxs)(el,{children:[(0,n.jsx)(en,{children:t}),(0,n.jsx)(ee,{type:"number",className:"w-20",value:a,onChange:e=>l(parseInt(e.target.value))})]})}function eE(e){let{error:t}=e;return t&&(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"my-4 text-red-500",children:t})})}eR.displayName=eh.ck.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)(eh.Z0,{ref:t,className:m("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=eh.Z0.displayName;let eZ=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:m("w-full caption-bottom text-sm",a),...l})})});eZ.displayName="Table";let eL=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("thead",{ref:t,className:m("[&_tr]:border-b",a),...l})});eL.displayName="TableHeader";let eA=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("tbody",{ref:t,className:m("[&_tr:last-child]:border-0",a),...l})});eA.displayName="TableBody";let eP=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("tfoot",{ref:t,className:m("border-t font-medium [&>tr]:last:border-b-0",a),...l})});eP.displayName="TableFooter";let eD=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("tr",{ref:t,className:m("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l})});eD.displayName="TableRow";let eV=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("th",{ref:t,className:m("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...l})});eV.displayName="TableHead";let e_=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("td",{ref:t,className:m("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...l})});e_.displayName="TableCell",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("caption",{ref:t,className:m("mt-4 text-sm text-muted-foreground",a),...l})}).displayName="TableCaption";var eF=a(51886);function eM(e){let{data:t,columns:a,types:l,nbRows:s}=e;return(0,n.jsxs)(eZ,{children:[(0,n.jsx)(eL,{children:(0,n.jsx)(eD,{children:a.map((e,t)=>(0,n.jsxs)(eV,{className:"pb-4",children:[(0,n.jsx)("div",{children:e}),(0,n.jsx)("div",{children:l[t]})]},t))})}),(0,n.jsx)(eA,{children:t.map((e,t)=>(0,n.jsx)(eD,{children:a.map((t,a)=>{var l;return e[t]instanceof Date?(0,n.jsx)(e_,{children:(0,eF.p6)(e[t],"Month DD, YYYY, at HH:MM period TZ",{utc:!0,abbreviations:!0})},a):"number"==typeof e[t]?(0,n.jsx)(e_,{children:(0,eF.uf)(e[t])},a):ArrayBuffer.isView(e[t])?(0,n.jsx)(e_,{children:"<Geometry>"},a):(0,n.jsx)(e_,{children:null===(l=e[t])||void 0===l?void 0:l.toString()},a)})},t))}),s&&(0,n.jsx)(eP,{children:(0,n.jsx)(eD,{children:(0,n.jsxs)(e_,{colSpan:a.length,className:"text-right",children:[(0,eF.uf)(s)," rows in total in the table"]})})})]})}var ez=a(48484);let eO=l.forwardRef((e,t)=>{let{className:a,orientation:l="horizontal",decorative:s=!0,...i}=e;return(0,n.jsx)(ez.f,{ref:t,decorative:s,orientation:l,className:m("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",a),...i})});function e$(e){let{label:t,items:a,set:s,values:i}=e;return(0,n.jsxs)("div",{className:"my-4",children:[(0,n.jsx)(en,{children:t}),(0,n.jsx)("div",{className:"flex items-center flex-wrap gap-2",children:a.map((e,o)=>(0,n.jsxs)(l.Fragment,{children:[0!==o&&o!==a.length-1&&(0,n.jsx)(eO,{orientation:"vertical",className:"h-5"},"".concat(t,"-sep-").concat(o)),(0,n.jsx)(ev,{smallMargin:!0,label:e.label,checked:i.includes(e.value),onChange:t=>{t?i.includes(e.value)||s([...i,e.value]):s(i.filter(t=>t!==e.value))}},"".concat(t,"-check-").concat(o))]},"".concat(t,"-div-").concat(o)))})]})}function eH(e){let{items:t,values:a,setValues:l}=e;return(0,n.jsx)(n.Fragment,{children:t.map((e,t)=>{var s;return(0,n.jsx)(es,{label:e.label,value:null!==(s=a[e.label])&&void 0!==s?s:"",onClick:t=>{let n={...a};n[e.label]=t,l(n)}},t)})})}eO.displayName=ez.f.displayName;let eJ=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.jsx)("textarea",{className:m("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...l})});function eY(e){let{label:t,set:a,value:s}=e,i=(0,l.useRef)(null),[o,r]=(0,l.useState)("");return(0,l.useEffect)(()=>{r(s)},[s]),(0,n.jsx)(el,{children:(0,n.jsxs)("div",{className:"grid w-full gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(en,{children:t}),(0,n.jsx)(eJ,{ref:i,value:o,onChange:e=>r(e.target.value),onKeyDown:e=>"Enter"===e.key&&e.shiftKey&&i.current?a(i.current.value):null})]}),(0,n.jsx)(D,{onClick:()=>{i.current&&"string"==typeof i.current.value&&a(i.current.value)},children:"Run"})]})})}eJ.displayName="Textarea";var eB=a(50750),eG={SDB:function(e){let{id:t}=e,{updateNodeData:a}=(0,s._K)(),[i,o]=(0,l.useState)(""),[r,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{(async function(){u(!0);let e=await new K.Z().start();await e.customQuery("ATTACH DATABASE '".concat(t,"' as mydb;\nuse mydb;"));let n='// For front-end projects, switch to SimpleWebDB\nimport { SimpleDB } from "simple-data-analysis";\n\nconst sdb = new SimpleDB();';o(n),a(t,{instance:e,code:n}),u(!1),d(!0)})()},[t,a]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:i}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:c,children:"SimpleDB"}),(0,n.jsx)(B,{children:"This is your in-memory database."})]})]}),(0,n.jsx)(I,{sourceReady:r})]})},ST:function(e){var t;let{id:a}=e,{updateNodeData:i}=(0,s._K)(),[o,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),[u,f]=(0,l.useState)(!1),m=(0,s.Vc)({type:"target"}),[x,p]=(0,l.useState)("".concat(a)),[v,h]=(0,l.useState)(""),g=(0,s.$P)(null===(t=m[0])||void 0===t?void 0:t.source),j=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==j?void 0:j.data.imported)&&("string"==typeof j.data.name&&p(j.data.name),j.data.imported=!1)},[j]),(0,l.useEffect)(()=>{var e;let t=null==g?void 0:null===(e=g.data)||void 0===e?void 0:e.instance;if(t instanceof K.Z){r(!0),f(!0);let e="const ".concat(x,' = sdb.newTable("').concat(x,'");');h(e),i(a,{name:x,instance:t.newTable(x),code:e}),f(!1),c(!0)}},[g,a,i,x]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:o}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:v}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:u,children:"SimpleTable"}),(0,n.jsx)(B,{children:"This is a table in the database."})]}),(0,n.jsx)(G,{children:(0,n.jsx)(es,{label:"Name",value:x,onClick:e=>p(e)})})]}),(0,n.jsx)(I,{sourceReady:d})]})},FetchData:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)(void 0),[r,d]=(0,l.useState)(!0),[c,u]=(0,l.useState)(void 0),[f,m]=(0,l.useState)(!0),[x,p]=(0,l.useState)(void 0),[v,h]=(0,l.useState)(0),{updateNodeData:g}=(0,s._K)(),j=(0,s.Vc)({type:"target"}),b=(0,s.$P)(null===(t=j[0])||void 0===t?void 0:t.source),[y,w]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1),[N,R]=(0,l.useState)(!1),[T,k]=(0,l.useState)(!1),[E,Z]=(0,l.useState)(null),L=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==L?void 0:L.data.imported)&&("string"==typeof L.data.url&&o(L.data.url),"string"==typeof L.data.fileType&&u(L.data.fileType),"boolean"==typeof L.data.autoDetect&&d(L.data.autoDetect),"boolean"==typeof L.data.header&&m(L.data.header),"string"==typeof L.data.delim&&p(L.data.delim),"number"==typeof L.data.skip&&h(L.data.skip),L.data.imported=!1)},[L]),(0,l.useEffect)(()=>{(async function(){var e;let t=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;if(t instanceof ei.Z&&R(!0),t instanceof ei.Z&&"string"==typeof i)try{C(!0),await t.fetchData(i,{fileType:c,autoDetect:r,header:f,delim:x,skip:v});let e="// More options available. Check documentation.\nawait ".concat(t.name,'.loadData("').concat(i,'", {\n  fileType: ').concat("string"==typeof c?'"'.concat(c,'"'):"undefined",",\n  autoDetect: ").concat(r,",\n  header: ").concat(f,",\n  delim: ").concat("string"==typeof x?'"'.concat(x,'"'):"undefined",",\n  skip: ").concat(v,",\n});");w(e),g(a,{instance:t,code:e,url:i,fileType:c,autoDetect:r,header:f,delim:x,skip:v}),Z(null),C(!1),k(!0)}catch(e){console.error(e),Z(e.message),C(!1),k(!0)}})()},[b,a,g,i,c,r,f,x,v]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:N}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:y}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:S,children:"Fetch data"}),(0,n.jsx)(B,{children:"Fetches data (CSV, JSON, and Parquet files) from a URL."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"URL",value:null!=i?i:"",onClick:e=>o(e)}),(0,n.jsx)(eE,{error:E}),(0,n.jsxs)(em,{children:[(0,n.jsx)(ev,{label:"Auto-detect",checked:r,onChange:e=>d(e)}),(0,n.jsx)(eT,{label:"File type:",value:null!=c?c:"",items:[{value:"csv",label:"CSV"},{value:"dsv",label:"DSV"},{value:"json",label:"JSON"},{value:"parquet",label:"Parquet"}],onChange:e=>u(e)}),(0,n.jsx)(ev,{checked:f,onChange:e=>m(e),label:"Header"}),(0,n.jsx)(es,{label:"Delimiter:",value:null!=x?x:",",onClick:e=>p(e)}),(0,n.jsx)(ek,{label:"Skip rows:",value:v,set:h})]})]})]}),(0,n.jsx)(I,{sourceReady:T})]})},LoadFile:function(e){var t;let{id:a}=e,i=(0,l.useRef)(null),[o,r]=(0,l.useState)(null),[d,c]=(0,l.useState)(!0),[u,f]=(0,l.useState)(void 0),[m,x]=(0,l.useState)(!0),[p,v]=(0,l.useState)(void 0),[h,g]=(0,l.useState)(0),{updateNodeData:j}=(0,s._K)(),b=(0,s.Vc)({type:"target"}),y=(0,s.$P)(null===(t=b[0])||void 0===t?void 0:t.source),[w,S]=(0,l.useState)(""),[C,N]=(0,l.useState)(!1),[R,T]=(0,l.useState)(!1),[k,E]=(0,l.useState)(!1),[Z,L]=(0,l.useState)(null),A=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==A?void 0:A.data.imported)&&("string"==typeof A.data.fileType&&f(A.data.fileType),"boolean"==typeof A.data.autoDetect&&c(A.data.autoDetect),"boolean"==typeof A.data.header&&x(A.data.header),"string"==typeof A.data.delim&&v(A.data.delim),"number"==typeof A.data.skip&&g(A.data.skip),A.data.imported=!1)},[A]),(0,l.useEffect)(()=>{(async function(){var e;let t=null==y?void 0:null===(e=y.data)||void 0===e?void 0:e.instance;if(t instanceof ei.Z&&T(!0),t instanceof ei.Z&&o instanceof File)try{N(!0);let e=t.db,n=t.connection,l=o.name.split(".").at(-1);"csv"===u||"csv"===l||"dsv"===u||"string"==typeof p?(await e.registerFileHandle(o.name,o,eB.qr.BROWSER_FILEREADER,!0),await n.insertCSVFromPath(o.name,{name:t.name,detect:null==d||d,header:null==m||m,delimiter:null!=p?p:",",skip:h})):"json"===u||"json"===l?(await e.registerFileText(o.name,await o.text()),await n.insertJSONFromPath(o.name,{name:t.name})):("parquet"===u||"parquet"===l)&&(await e.registerFileHandle(o.name,o,eB.qr.BROWSER_FILEREADER,!0),await n.query("CREATE OR REPLACE TABLE ".concat(t.name," AS SELECT * FROM parquet_scan('").concat(o.name,"')")));let s="// More options available. Check documentation.\nawait ".concat(t.name,'.loadData("').concat(o.name,'", {\n  fileType: ').concat("string"==typeof u?'"'.concat(u,'"'):"undefined",",\n  autoDetect: ").concat(d,",\n  header: ").concat(m,",\n  delim: ").concat("string"==typeof p?'"'.concat(p,'"'):"undefined",",\n  skip: ").concat(h,",\n});");S(s),j(a,{instance:t,code:s,fileType:u,autoDetect:d,header:m,delim:p,skip:h}),L(null),N(!1),E(!0)}catch(e){console.error(e),L(e.message),N(!1),E(!0)}})()},[y,a,j,o,u,d,m,p,h]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:R}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:w}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:C,children:"Load file"}),(0,n.jsx)(B,{children:"Loads data from a local CSV, JSON or Parquet file."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)("div",{className:"flex items-center space-x-2 my-4",children:(0,n.jsx)(ee,{ref:i,type:"file",onChange:e=>{let t=e.target.files;t&&r(t[0])}})}),(0,n.jsx)(eE,{error:Z}),(0,n.jsxs)(em,{children:[(0,n.jsx)(ev,{label:"Auto-detect",checked:d,onChange:e=>c(e)}),(0,n.jsx)(eT,{label:"File type:",placeholder:"",items:[{value:"csv",label:"CSV"},{value:"dsv",label:"DSV"},{value:"json",label:"JSON"},{value:"parquet",label:"Parquet"}],onChange:e=>f(e),value:null!=u?u:""}),(0,n.jsx)(ev,{checked:m,onChange:e=>x(e),label:"Header"}),(0,n.jsx)(es,{label:"Delimiter:",value:null!=p?p:"",onClick:e=>v(e)}),(0,n.jsx)(ek,{label:"Skip rows:",value:h,set:g})]})]})]}),(0,n.jsx)(I,{sourceReady:k})]})},LoadGeoFile:function(e){var t;let{id:a}=e,i=(0,l.useRef)(null),[o,r]=(0,l.useState)(null),{updateNodeData:d}=(0,s._K)(),c=(0,s.Vc)({type:"target"}),u=(0,s.$P)(null===(t=c[0])||void 0===t?void 0:t.source),[f,m]=(0,l.useState)(""),[x,p]=(0,l.useState)(!1),[v,h]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),[b,y]=(0,l.useState)(null);return(0,l.useEffect)(()=>{(async function(){var e;let t=null==u?void 0:null===(e=u.data)||void 0===e?void 0:e.instance;if(t instanceof ei.Z&&h(!0),t instanceof ei.Z&&o instanceof File)try{p(!0);let e=t.db;await e.registerFileHandle(o.name,o,eB.qr.BROWSER_FILEREADER,!0),await t.sdb.customQuery("INSTALL spatial; LOAD spatial;\n            INSTALL https; LOAD https;\n            CREATE OR REPLACE TABLE ".concat(t.name," AS SELECT * FROM ST_Read('").concat(o.name,"');"));let n="// More options available. Check documentation.\nawait ".concat(t.name,'.loadGeoData("').concat(o.name,'");');m(n),d(a,{instance:t,code:n}),y(null),p(!1),j(!0)}catch(e){console.error(e),y(e.message),p(!1),j(!0)}})()},[u,a,d,o]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:v}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:f}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:x,children:"Load geo file"}),(0,n.jsx)(B,{children:"Loads spatial data from a local file."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)("div",{className:"flex items-center space-x-2 my-4",children:(0,n.jsx)(ee,{ref:i,type:"file",onChange:e=>{let t=e.target.files;t&&r(t[0])}})}),(0,n.jsx)(eE,{error:b})]})]}),(0,n.jsx)(I,{sourceReady:g})]})},FetchGeoData:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)(void 0),{updateNodeData:r}=(0,s._K)(),d=(0,s.Vc)({type:"target"}),c=(0,s.$P)(null===(t=d[0])||void 0===t?void 0:t.source),[u,f]=(0,l.useState)(""),[m,x]=(0,l.useState)(!1),[p,v]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)(null),y=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==y?void 0:y.data.imported)&&("string"==typeof y.data.url&&o(y.data.url),y.data.imported=!1)},[y]),(0,l.useEffect)(()=>{(async function(){var e;let t=null==c?void 0:null===(e=c.data)||void 0===e?void 0:e.instance;if(t instanceof ei.Z&&v(!0),t instanceof ei.Z&&"string"==typeof i)try{x(!0),await t.fetchGeoData(i);let e="// For front-end projects, use fetchGeoData. \nawait ".concat(t.name,'.loadGeoData("').concat(i,'");');f(e),r(a,{instance:t,code:e,url:i}),b(null),x(!1),g(!0)}catch(e){console.error(e),b(e.message),x(!1),g(!1)}})()},[c,a,r,i]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:p}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:u}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:m,children:"Fetch geo data"}),(0,n.jsx)(B,{children:"Fetches spatial data from a URL."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"URL",value:null!=i?i:"",onClick:e=>o(e)}),(0,n.jsx)(eE,{error:j})]})]}),(0,n.jsx)(I,{sourceReady:h})]})},LogTable:function(e){var t;let{id:a}=e,{updateNodeData:i}=(0,s._K)(),[o,r]=(0,l.useState)(void 0),[d,c]=(0,l.useState)(null),[u,f]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[p,v]=(0,l.useState)(null),[h,g]=(0,l.useState)(5),j=(0,s.Vc)({type:"target"}),b=(0,s.$P)(null===(t=j[0])||void 0===t?void 0:t.source),[y,w]=(0,l.useState)(!1),[S,C]=(0,l.useState)(""),[N,R]=(0,l.useState)(""),[T,k]=(0,l.useState)(!1),E=(0,s.$P)(a);(0,l.useEffect)(()=>{(null==E?void 0:E.data.imported)&&("number"==typeof E.data.nbRowsToLog&&g(E.data.nbRowsToLog),E.data.imported=!1)},[E]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z){w(!0),k(!0),c(await l.getTop(null!=h?h:5));let e=await l.getColumns(),s=await l.getTypes(),o=e.map(e=>s[e]),d=await l.getNbRows();f(e),x(o),v(d);let u=null!==(n=null==b?void 0:null===(t=b.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name;r(u);let m="await ".concat(u,".logTable(").concat(null!=h?h:5,")");C(m),i(a,{instance:l,code:m,nbRowsToLog:null!=h?h:5}),o.some(e=>"GEOMETRY"===e)?R("Download as GeoJSON"):R("Download as CSV"),k(!1)}else c(null),f(null),x(null),v(null)})()},[b,h,a,i]);let Z=(0,l.useCallback)(async()=>{var e;let t=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;if(t instanceof ei.Z){if(Object.values(await t.getTypes()).some(e=>"GEOMETRY"===e)){let e=JSON.stringify(await t.getGeoData()),a=document.createElement("a"),n=new Blob([e],{type:"text/plain"});a.href=URL.createObjectURL(n),a.download="".concat(o,".geojson"),a.click()}else{let e=await t.getData(),a=(0,eF.vB)(e),n=document.createElement("a"),l=new Blob([a],{type:"text/plain"});n.href=URL.createObjectURL(l),n.download="".concat(o,".csv"),n.click()}}},[b,o]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:y}),(0,n.jsxs)(H,{className:"min-w-96",children:[(0,n.jsx)(_,{code:S}),(0,n.jsxs)(J,{children:[(0,n.jsxs)(W,{loader:T,children:["Log table","string"==typeof o?" ".concat(o):""]}),null===d&&(0,n.jsx)(B,{children:"No data."})]}),Array.isArray(d)&&Array.isArray(u)&&Array.isArray(m)&&"number"==typeof p&&(0,n.jsxs)(G,{children:[(0,n.jsx)(ek,{label:"Number of rows to show:",value:h,set:g}),(0,n.jsx)(eM,{data:d,columns:u,types:m,nbRows:p}),(0,n.jsx)("div",{className:"text-right",children:(0,n.jsx)(D,{variant:"secondary",onClick:Z,children:N})})]})]})]})},Points:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)(void 0),[r,d]=(0,l.useState)(void 0),[c,u]=(0,l.useState)("geom"),[f,m]=(0,l.useState)([]),{updateNodeData:x}=(0,s._K)(),p=(0,s.Vc)({type:"target"}),v=(0,s.$P)(null===(t=p[0])||void 0===t?void 0:t.source),[h,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)(!1);(0,l.useEffect)(()=>{!async function(){var e;let t=null==v?void 0:null===(e=v.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&m((await t.getColumns()).map(e=>({value:e,label:e})))}()},[v]);let[y,w]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1),[N,R]=(0,l.useState)(null),T=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==T?void 0:T.data.imported)&&(T.data.columns&&"object"==typeof T.data.columns&&m(T.data.columns),"string"==typeof T.data.lat&&o(T.data.lat),"string"==typeof T.data.lon&&d(T.data.lon),"string"==typeof T.data.newColumn&&u(T.data.newColumn),T.data.imported=!1)},[T]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==v?void 0:null===(e=v.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&g(!0),l instanceof ei.Z&&"string"==typeof i&&"string"==typeof r&&"string"==typeof c)try{C(!0);let e=await l.cloneTable({outputTable:a});await e.points(i,r,c);let s=null!==(n=null==v?void 0:null===(t=v.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="await ".concat(s,'.points("').concat(i,'", "').concat(r,'", "').concat(c,'");');w(o),x(a,{instance:e,originalTableName:s,code:o,lat:i,lon:r,newColumn:c,columns:f}),R(null),C(!1),b(!0)}catch(e){console.error(e),R(e.message),C(!1),b(!1)}})()},[v,a,x,i,r,f,c]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:h}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:y}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:S,children:"Points"}),(0,n.jsx)(B,{children:"Creates point geometries from longitude and latitude columns."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(eT,{label:"Latitude",placeholder:"Pick a column",items:f,onChange:e=>o(e),value:null!=i?i:""}),(0,n.jsx)(eT,{label:"Longitude",placeholder:"Pick a column",items:f,onChange:e=>d(e),value:null!=r?r:""}),(0,n.jsx)(es,{label:"New column",value:c,onClick:e=>u(e)}),(0,n.jsx)(eE,{error:N})]})]}),(0,n.jsx)(I,{sourceReady:j})]})},JoinGeo:function(e){var t,a;let{id:i}=e,[o,r]=(0,l.useState)("".concat(i,"JoinGeo")),[d,c]=(0,l.useState)([]),[u,f]=(0,l.useState)([]),[m,x]=(0,l.useState)(void 0),[p,v]=(0,l.useState)(void 0),[h,g]=(0,l.useState)(void 0),[j,b]=(0,l.useState)(void 0),[y,w]=(0,l.useState)(void 0),[S,C]=(0,l.useState)(void 0),{updateNodeData:N}=(0,s._K)(),R=(0,s.Vc)({type:"target",id:"left"}),T=(0,s.$P)(null===(t=R[0])||void 0===t?void 0:t.source);(0,l.useEffect)(()=>{!async function(){var e;let t=null==T?void 0:null===(e=T.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&c((await t.getColumns()).map(e=>({value:e,label:e})))}()},[T]);let k=(0,s.Vc)({type:"target",id:"right"}),E=(0,s.$P)(null===(a=k[0])||void 0===a?void 0:a.source);(0,l.useEffect)(()=>{!async function(){var e;let t=null==E?void 0:null===(e=E.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&f((await t.getColumns()).map(e=>({value:e,label:e})))}()},[E]);let[Z,L]=(0,l.useState)(""),[A,P]=(0,l.useState)(!1),[D,V]=(0,l.useState)(!1),[F,M]=(0,l.useState)(!1),[z,O]=(0,l.useState)(!1),[$,Y]=(0,l.useState)(null),K=(0,s.$P)(i);return(0,l.useEffect)(()=>{(null==K?void 0:K.data.imported)&&("string"==typeof K.data.method&&g(K.data.method),"string"==typeof K.data.outputTable&&r(K.data.outputTable),"string"==typeof K.data.geoLeft&&x(K.data.geoLeft),"string"==typeof K.data.geoRight&&v(K.data.geoRight),"number"==typeof K.data.distance&&b(K.data.distance),"string"==typeof K.data.distanceMethod&&w(K.data.distanceMethod),"string"==typeof K.data.joinType&&C(K.data.joinType),Array.isArray(K.data.columnsLeft)&&c(K.data.columnsLeft),Array.isArray(K.data.columnsRight)&&f(K.data.columnsRight),K.data.imported=!1)},[K]),(0,l.useEffect)(()=>{(async function(){var e,t,a,n,l,s;let r=null==T?void 0:null===(e=T.data)||void 0===e?void 0:e.instance,c=null==E?void 0:null===(t=E.data)||void 0===t?void 0:t.instance;if(r instanceof ei.Z&&M(!0),c instanceof ei.Z&&O(!0),r instanceof ei.Z&&c instanceof ei.Z&&"string"==typeof m&&"string"==typeof p&&await r.hasColumn(m)&&await c.hasColumn(p)&&"string"==typeof h)try{P(!0);let e=null!==(l=null==T?void 0:null===(a=T.data)||void 0===a?void 0:a.originalTableName)&&void 0!==l?l:r.name,t=null!==(s=null==E?void 0:null===(n=E.data)||void 0===n?void 0:n.originalTableName)&&void 0!==s?s:c.name,f="const ".concat(o," = await ").concat(e,".joinGeo(").concat(t,', "').concat(h,'", {\n  leftTableColumn: "').concat(m,'",\n  rightTableColumn: "').concat(p,'",\n  distance: ').concat(j,",\n  distanceMethod: ").concat("string"==typeof y?'"'.concat(y,'"'):"undefined",',\n  type: "').concat(null!=S?S:"left",'",\n  outputTable: "').concat(o,'",\n})');L(f);let x=await r.joinGeo(c,h,{leftTableColumn:m,rightTableColumn:p,distance:j,distanceMethod:y,type:S,outputTable:o});N(i,{instance:x,originalTableName:o,code:f,method:h,outputTable:o,geoLeft:m,geoRight:p,distance:j,distanceMethod:y,joinType:S,columnsLeft:d,columnsRight:u}),Y(null),P(!1),V(!0)}catch(e){console.error(e),Y(e.message),P(!1),V(!0)}})()},[T,E,i,N,m,p,h,j,y,S,o,d,u]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-evenly -translate-x-[42%]",children:[(0,n.jsx)(Q,{targetReady:F,id:"left"}),(0,n.jsx)(Q,{targetReady:z,id:"right"})]}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:Z}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:A,children:"Join geo"}),(0,n.jsx)(B,{children:"Joins two tables based on geometries."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"Table name",value:o,onClick:e=>r(e)}),(0,n.jsx)(eT,{label:"Left geometries",placeholder:"Pick a column",items:d,onChange:e=>x(e),value:null!=m?m:""}),(0,n.jsx)(eT,{label:"Right geometries",placeholder:"Pick a column",items:u,onChange:e=>v(e),value:null!=p?p:""}),(0,n.jsx)(eT,{label:"Method:",placeholder:"Pick a method",value:null!=h?h:"",items:[{value:"intersect",label:"Intersect"},{value:"inside",label:"Inside"},{value:"within",label:"Within"}],onChange:e=>g(e)}),(0,n.jsx)(eE,{error:$}),(0,n.jsxs)(em,{children:[(0,n.jsx)(ek,{label:"Distance (for method Within):",value:null!=j?j:0,set:b}),(0,n.jsx)(eT,{label:"Distance method (if Haversine or Spheroid, the distance unit is meter):",value:null!=y?y:"",items:[{value:"SRS",label:"SRS"},{value:"haversine",label:"Haversine"},{value:"spheroid",label:"Spheroid"}],onChange:e=>w(e)}),(0,n.jsx)(eT,{label:"Join type",value:null!=S?S:"",items:[{value:"left",label:"Left"},{value:"inner",label:"Inner"},{value:"full",label:"Full"},{value:"right",label:"right"}],onChange:e=>C(e)})]})]})]}),(0,n.jsx)(I,{sourceReady:D})]})},Summarize:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)("".concat(a,"Summarize")),[r,d]=(0,l.useState)(),[c,u]=(0,l.useState)(),[f,m]=(0,l.useState)(["count"]),[x,p]=(0,l.useState)(2),[v,h]=(0,l.useState)([]),{updateNodeData:g}=(0,s._K)(),j=(0,s.Vc)({type:"target"}),b=(0,s.$P)(null===(t=j[0])||void 0===t?void 0:t.source);(0,l.useEffect)(()=>{!async function(){var e;let t=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&h((await t.getColumns()).map(e=>({value:e,label:e})))}()},[b]);let[y,w]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1),[N,R]=(0,l.useState)(!1),[T,k]=(0,l.useState)(!1),[E,Z]=(0,l.useState)(null),L=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==L?void 0:L.data.imported)&&("string"==typeof L.data.outputTable&&o(L.data.outputTable),Array.isArray(L.data.values)&&d(L.data.values),Array.isArray(L.data.categories)&&u(L.data.categories),Array.isArray(L.data.summaries)&&m(L.data.summaries),"number"==typeof L.data.decimals&&(console.log("coucou",L.data.decimals),p(L.data.decimals)),Array.isArray(L.data.columns)&&h(L.data.columns),L.data.imported=!1)},[L]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&R(!0),l instanceof ei.Z&&(null==r?void 0:r.length))try{C(!0);let e=await l.summarize({values:r,categories:c,summaries:f,decimals:x,outputTable:i}),s=null!==(n=null==b?void 0:null===(t=b.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="const ".concat(i," = await ").concat(s,".summarize({\n  values: ").concat(JSON.stringify(r),",\n  categories: ").concat(JSON.stringify(c),",\n  summaries: ").concat(JSON.stringify(f),",\n  decimals: ").concat(x,',\n  outputTable: "').concat(i,'",\n});');w(o),g(a,{instance:e,originalTableName:i,code:o,outputTable:i,values:r,categories:c,summaries:f,decimals:x,columns:v}),Z(null),C(!1),k(!0)}catch(e){console.error(e),Z(e.message),C(!1),k(!1)}})()},[b,a,g,r,c,f,x,i,v]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:N}),(0,n.jsxs)(H,{className:"min-w-60 max-w-md",children:[(0,n.jsx)(_,{code:y}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:S,children:"Summarize"}),(0,n.jsx)(B,{children:"Aggregates the data."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"Table name",value:i,onClick:e=>o(e)}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e$,{label:"Values",items:v,set:d,values:null!=r?r:[]}),(0,n.jsx)(e$,{label:"Categories",items:v,set:u,values:null!=c?c:[]}),(0,n.jsx)(e$,{label:"Summaries",items:[{value:"count",label:"Count"},{value:"countUnique",label:"Count uniques"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"mean",label:"Mean"},{value:"median",label:"Median"},{value:"sum",label:"Sum"},{value:"skew",label:"Skew"},{value:"stdDev",label:"Standard deviation"},{value:"var",label:"Variance"}],values:null!=f?f:[],set:m}),(0,n.jsx)(ek,{label:"Decimals",value:x,set:p})]}),(0,n.jsx)(eE,{error:E})]})]}),(0,n.jsx)(I,{sourceReady:T})]})},RenameColumns:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)({}),[r,d]=(0,l.useState)([]),{updateNodeData:c}=(0,s._K)(),u=(0,s.Vc)({type:"target"}),f=(0,s.$P)(null===(t=u[0])||void 0===t?void 0:t.source),[m,x]=(0,l.useState)(!1),[p,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{!async function(){var e;let t=null==f?void 0:null===(e=f.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&d((await t.getColumns()).map(e=>({label:e,defaultValue:e})))}()},[f]);let[h,g]=(0,l.useState)(""),[j,b]=(0,l.useState)(!1),[y,w]=(0,l.useState)(null),S=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==S?void 0:S.data.imported)&&("object"==typeof S.data.columnsToRename&&o(S.data.columnsToRename),Array.isArray(S.data.columns)&&d(S.data.columns),S.data.imported=!1)},[S]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==f?void 0:null===(e=f.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&x(!0),l instanceof ei.Z)try{b(!0);let e=await l.cloneTable({outputTable:a});await e.renameColumns(i);let s=null!==(n=null==f?void 0:null===(t=f.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="await ".concat(s,".renameColumns(").concat(JSON.stringify(i),");");g(o),c(a,{instance:e,originalTableName:s,code:o,columnsToRename:i,columns:r}),w(null),b(!1),v(!0)}catch(e){console.error(e),w(e.message),b(!1),v(!1)}})()},[f,a,c,i,r]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:m}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:h}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:j,children:"Rename columns"}),(0,n.jsx)(B,{children:"Avoid spaces and special characters."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(eH,{items:r,values:i,setValues:o}),(0,n.jsx)(eE,{error:y})]})]}),(0,n.jsx)(I,{sourceReady:p})]})},Sort:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)(void 0),[r,d]=(0,l.useState)("asc"),[c,u]=(0,l.useState)([]),{updateNodeData:f}=(0,s._K)(),m=(0,s.Vc)({type:"target"}),x=(0,s.$P)(null===(t=m[0])||void 0===t?void 0:t.source),[p,v]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{!async function(){var e;let t=null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&u((await t.getColumns()).map(e=>({value:e,label:e})))}()},[x]);let[j,b]=(0,l.useState)(""),[y,w]=(0,l.useState)(!1),[S,C]=(0,l.useState)(null),N=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==N?void 0:N.data.imported)&&("string"==typeof N.data.columnToSort&&o(N.data.columnToSort),"string"==typeof N.data.order&&d(N.data.order),N.data.imported=!1)},[N]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&v(!0),l instanceof ei.Z&&"string"==typeof i&&"string"==typeof r)try{w(!0);let e=await l.cloneTable({outputTable:a}),s={};s[i]=r,await e.sort(s);let o=null!==(n=null==x?void 0:null===(t=x.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,d="await ".concat(o,".sort(").concat(JSON.stringify(s),");");b(d),f(a,{instance:e,originalTableName:o,code:d,columnToSort:i,order:r}),C(null),w(!1),g(!0)}catch(e){console.error(e),C(e.message),w(!1),g(!1)}})()},[x,a,f,i,r]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:p}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:j}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:y,children:"Sort"}),(0,n.jsx)(B,{children:"Sort values in ascending or descending order."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(eT,{label:"Column",placeholder:"Pick a column",value:null!=i?i:"",onChange:e=>o(e),items:c}),(0,n.jsx)(eT,{label:"Order",value:r,onChange:e=>d(e),items:[{value:"asc",label:"Ascending"},{value:"desc",label:"Descending"}]}),(0,n.jsx)(eE,{error:S})]})]}),(0,n.jsx)(I,{sourceReady:h})]})},AddColumn:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)("newColumn"),[r,d]=(0,l.useState)(void 0),[c,u]=(0,l.useState)(void 0),{updateNodeData:f}=(0,s._K)(),m=(0,s.Vc)({type:"target"}),x=(0,s.$P)(null===(t=m[0])||void 0===t?void 0:t.source),[p,v]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)(""),[y,w]=(0,l.useState)(!1),[S,C]=(0,l.useState)(null),N=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==N?void 0:N.data.imported)&&("string"==typeof N.data.newColumn&&o(N.data.newColumn),"string"==typeof N.data.dataType&&d(N.data.dataType),"string"==typeof N.data.definition&&u(N.data.definition),N.data.imported=!1)},[N]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&v(!0),l instanceof ei.Z&&"string"==typeof i&&"string"==typeof r&&"string"==typeof c)try{w(!0);let e=await l.cloneTable({outputTable:a});await e.addColumn(i,r,c);let s=null!==(n=null==x?void 0:null===(t=x.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="await ".concat(s,'.addColumn("').concat(i,'", "').concat(r,'", `').concat(c,"`);");b(o),f(a,{instance:e,originalTableName:s,code:o,newColumn:i,dataType:r,definition:c}),C(null),w(!1),g(!0)}catch(e){console.error(e),C(e.message),w(!1),g(!1)}})()},[x,a,f,i,r,c]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:p}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:j}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:y,children:"Add column"}),(0,n.jsx)(B,{children:"Adds a column into the table. The definition is in SQL."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"New column",value:i,onClick:e=>o(e)}),(0,n.jsx)(eT,{label:"Data type",value:null!=r?r:"",items:[{value:"string",label:"Text"},{value:"number",label:"Number"},{value:"boolean",label:"Boolean"},{value:"date",label:"Date"},{value:"geometry",label:"Geometry"}],onChange:e=>d(e)}),(0,n.jsx)(eY,{label:"Definition",set:u,value:null!=c?c:""}),(0,n.jsx)(eE,{error:S})]})]}),(0,n.jsx)(I,{sourceReady:h})]})},Filter:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)(void 0),{updateNodeData:r}=(0,s._K)(),d=(0,s.Vc)({type:"target"}),c=(0,s.$P)(null===(t=d[0])||void 0===t?void 0:t.source),[u,f]=(0,l.useState)(!1),[m,x]=(0,l.useState)(!1),[p,v]=(0,l.useState)(""),[h,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)(null),y=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==y?void 0:y.data.imported)&&("string"==typeof y.data.definition&&o(y.data.definition),y.data.imported=!1)},[y]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==c?void 0:null===(e=c.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&f(!0),l instanceof ei.Z&&"string"==typeof i)try{g(!0);let e=await l.cloneTable({outputTable:a});await e.filter(i);let s=null!==(n=null==c?void 0:null===(t=c.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="await ".concat(s,".filter(`").concat(i,"`);");v(o),r(a,{instance:e,originalTableName:s,code:o,definition:i}),b(null),g(!1),x(!0)}catch(e){console.error(e),b(e.message),g(!1),x(!1)}})()},[c,a,r,i]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:u}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:p}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:h,children:"Filter"}),(0,n.jsx)(B,{children:"Filter rows in the table. The condition is in SQL."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(eY,{label:"Condition",set:o,value:null!=i?i:""}),(0,n.jsx)(eE,{error:j})]})]}),(0,n.jsx)(I,{sourceReady:m})]})},Join:function(e){var t,a;let{id:i}=e,[o,r]=(0,l.useState)("".concat(i,"Join")),[d,c]=(0,l.useState)([]),[u,f]=(0,l.useState)(void 0),[m,x]=(0,l.useState)(void 0),{updateNodeData:p}=(0,s._K)(),v=(0,s.Vc)({type:"target",id:"left"}),h=(0,s.$P)(null===(t=v[0])||void 0===t?void 0:t.source),g=(0,s.Vc)({type:"target",id:"right"}),j=(0,s.$P)(null===(a=g[0])||void 0===a?void 0:a.source);(0,l.useEffect)(()=>{!async function(){var e,t;let a=null==h?void 0:null===(e=h.data)||void 0===e?void 0:e.instance,n=null==j?void 0:null===(t=j.data)||void 0===t?void 0:t.instance;if(a instanceof ei.Z&&n instanceof ei.Z){let e=await a.getColumns(),t=await n.getColumns(),l=[];for(let a of e){let e=t.find(e=>e===a);e&&l.push(e)}c(l.map(e=>({value:e,label:e})))}}()},[h,j]);let[b,y]=(0,l.useState)(""),[w,S]=(0,l.useState)(!1),[C,N]=(0,l.useState)(!1),[R,T]=(0,l.useState)(!1),[k,E]=(0,l.useState)(!1),[Z,L]=(0,l.useState)(null),A=(0,s.$P)(i);return(0,l.useEffect)(()=>{(null==A?void 0:A.data.imported)&&("string"==typeof A.data.commonColumn&&f(A.data.commonColumn),"string"==typeof A.data.joinType&&x(A.data.joinType),"string"==typeof A.data.outputTable&&r(A.data.outputTable),A.data.imported=!1)},[A]),(0,l.useEffect)(()=>{(async function(){1===d.length&&f(d[0].value)})()},[d]),(0,l.useEffect)(()=>{(async function(){var e,t,a,n,l,s;let r=null==h?void 0:null===(e=h.data)||void 0===e?void 0:e.instance,d=null==j?void 0:null===(t=j.data)||void 0===t?void 0:t.instance;if(r instanceof ei.Z&&T(!0),d instanceof ei.Z&&E(!0),r instanceof ei.Z&&d instanceof ei.Z&&"string"==typeof u)try{S(!0);let e=await r.join(d,{commonColumn:u,type:m,outputTable:o}),t=null!==(l=null==h?void 0:null===(a=h.data)||void 0===a?void 0:a.originalTableName)&&void 0!==l?l:r.name,c=null!==(s=null==j?void 0:null===(n=j.data)||void 0===n?void 0:n.originalTableName)&&void 0!==s?s:d.name,f="const ".concat(o," = await ").concat(t,".join(").concat(c,', {\n  commonColumn: "').concat(u,'",\n  type: "').concat(null!=m?m:"left",'",\n  outputTable: "').concat(o,'",\n})');y(f),p(i,{instance:e,originalTableName:o,code:f,commonColumn:u,joinType:m,outputTable:o}),L(null),S(!1),N(!0)}catch(e){console.error(e),L(e.message),S(!1),N(!0)}})()},[h,j,i,p,u,m,o]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-evenly -translate-x-[42%]",children:[(0,n.jsx)(Q,{targetReady:R,id:"left"}),(0,n.jsx)(Q,{targetReady:k,id:"right"})]}),(0,n.jsxs)(H,{children:[(0,n.jsx)(_,{code:b}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:w,children:"Join"}),(0,n.jsx)(B,{children:"Joins two tables based on a common column."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"Table name",value:o,onClick:e=>r(e)}),(0,n.jsx)(eT,{label:"Common column",placeholder:"Pick a column",items:d,onChange:e=>f(e),value:null!=u?u:""}),(0,n.jsx)(eE,{error:Z}),(0,n.jsx)(em,{children:(0,n.jsx)(eT,{label:"Join type",value:null!=m?m:"",items:[{value:"left",label:"Left"},{value:"inner",label:"Inner"},{value:"full",label:"Full"},{value:"right",label:"right"}],onChange:e=>x(e)})})]})]}),(0,n.jsx)(I,{sourceReady:C})]})},LinearRegressions:function(e){var t;let{id:a}=e,[i,o]=(0,l.useState)("".concat(a,"LinearRegression")),[r,d]=(0,l.useState)(),[c,u]=(0,l.useState)(),[f,m]=(0,l.useState)(["count"]),[x,p]=(0,l.useState)(2),[v,h]=(0,l.useState)([]),{updateNodeData:g}=(0,s._K)(),j=(0,s.Vc)({type:"target"}),b=(0,s.$P)(null===(t=j[0])||void 0===t?void 0:t.source);(0,l.useEffect)(()=>{!async function(){var e;let t=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;t instanceof ei.Z&&h((await t.getColumns()).map(e=>({value:e,label:e})))}()},[b]);let[y,w]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1),[N,R]=(0,l.useState)(!1),[T,k]=(0,l.useState)(!1),[E,Z]=(0,l.useState)(null),L=(0,s.$P)(a);return(0,l.useEffect)(()=>{(null==L?void 0:L.data.imported)&&("string"==typeof L.data.x&&d(L.data.x),"string"==typeof L.data.y&&u(L.data.y),Array.isArray(L.data.categories)&&m(L.data.categories),"number"==typeof L.data.decimals&&p(L.data.decimals),"string"==typeof L.data.outputTable&&o(L.data.outputTable),L.data.imported=!1)},[L]),(0,l.useEffect)(()=>{(async function(){var e,t,n;let l=null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.instance;if(l instanceof ei.Z&&R(!0),l instanceof ei.Z&&"string"==typeof r&&"string"==typeof c)try{C(!0);let e=await l.linearRegressions({x:r,y:c,categories:f,decimals:x,outputTable:i}),s=null!==(n=null==b?void 0:null===(t=b.data)||void 0===t?void 0:t.originalTableName)&&void 0!==n?n:l.name,o="const ".concat(i," = await ").concat(s,'.linearRegressions({\n  x: "').concat(r,'",\n  y: "').concat(c,'",\n  categories: ').concat(JSON.stringify(f),",\n  decimals: ").concat(x,',\n  outputTable: "').concat(i,'",\n});');w(o),g(a,{instance:e,originalTableName:i,code:o,x:r,y:c,categories:f,decimals:x,outputTable:i}),Z(null),C(!1),k(!0)}catch(e){console.error(e),Z(e.message),C(!1),k(!1)}})()},[b,a,g,r,c,f,x,i]),(0,n.jsxs)("div",{children:[(0,n.jsx)(Q,{targetReady:N}),(0,n.jsxs)(H,{className:"min-w-60 max-w-md",children:[(0,n.jsx)(_,{code:y}),(0,n.jsxs)(J,{children:[(0,n.jsx)(W,{loader:S,children:"Linear regressions"}),(0,n.jsx)(B,{children:"The results include the slope, the y-intercept the R-squared."})]}),(0,n.jsxs)(G,{children:[(0,n.jsx)(es,{label:"Table name",value:i,onClick:e=>o(e)}),N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eT,{label:"X",items:v,placeholder:"Pick a column",value:null!=r?r:"",onChange:e=>d(e)}),(0,n.jsx)(eT,{label:"Y",items:v,placeholder:"Pick a column",value:null!=c?c:"",onChange:e=>u(e)}),(0,n.jsx)(e$,{label:"Categories",items:v,values:null!=f?f:[],set:m}),(0,n.jsx)(ek,{label:"Decimals",value:x,set:p})]}),(0,n.jsx)(eE,{error:E})]})]}),(0,n.jsx)(I,{sourceReady:T})]})}};function eK(e){let{rfInstance:t,setNodes:a,setEdges:o}=e,{setViewport:r}=(0,s._K)(),d=(0,l.useRef)(null),c=(0,l.useCallback)(()=>{if(t){let e=JSON.stringify(t.toObject()),a=document.createElement("a"),n=new Blob([e],{type:"text/plain"});a.href=URL.createObjectURL(n),a.download="sda-flow.json",a.click()}},[t]);return(0,n.jsx)("div",{className:"z-10",children:(0,n.jsxs)("div",{className:"absolute m-2 flex gap-2",children:[(0,n.jsx)(D,{variant:"outline",onClick:c,children:"Save"}),(0,n.jsx)(D,{variant:"outline",onClick:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.click()},children:"Import"}),(0,n.jsx)(ee,{className:"hidden",ref:d,type:"file",onChange:async e=>{let n=e.target.files;if(n){let e=JSON.parse(await n[0].text()),l=e.nodes.map(e=>({...e,data:{...e.data,imported:!0}}));a(l||[]),o(e.edges||[]);let s=(0,i.RX)(l);null==t||t.fitBounds(s,{padding:0})}}})]})})}function eI(){let[e,t]=(0,l.useState)(),[a,o]=(0,l.useState)("0");(0,l.useEffect)(()=>{function e(){let e=document.querySelector("#header");if(e){let t=e.getBoundingClientRect();o("".concat(window.innerHeight-t.height,"px"))}}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let[r,d,c]=(0,s.Rr)(O),[u,f,m]=(0,s.ll)($),x=(0,l.useCallback)(e=>f(t=>(0,i.Z_)(e,t.filter(t=>t.targetHandle&&e.targetHandle?t.target!==e.target||t.targetHandle!==e.targetHandle:t.target!==e.target))),[f]);return"0"!==a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eK,{rfInstance:e,setNodes:d,setEdges:f}),(0,n.jsx)(F,{}),(0,n.jsx)(C,{setNodes:d,children:(0,n.jsx)("div",{style:{width:"100vw",height:a},children:(0,n.jsxs)(s.x$,{nodes:r,edges:u,onNodesChange:c,onEdgesChange:m,onConnect:x,nodeTypes:eG,fitView:!0,fitViewOptions:{padding:.1},minZoom:.25,defaultEdgeOptions:{type:"smoothstep",markerEnd:{type:i.QZ.Arrow,width:20,height:20}},connectionRadius:50,connectionLineType:i.t8.SmoothStep,onInit:t,children:[(0,n.jsx)(s.ZX,{}),(0,n.jsx)(s.Aq,{variant:s.T7.Dots,gap:12,size:1})]})})})]})}}},function(e){e.O(0,[3545,8319,3067,4324,2971,7023,1744],function(){return e(e.s=88874)}),_N_E=e.O()}]);